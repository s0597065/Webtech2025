<main class="d-flex min-vh-100">
  <fieldset class="container">

    @if(book) {
      <legend class="mb-4">
        Bucheintrag zu {{ book.title }} von {{ book.author }} aktualisieren
      </legend>
    } @else {
      <legend class="mb-4">Bucheintrag aktualisieren</legend>
    }

    <form [formGroup]="form" (ngSubmit)="update()">

      <!-- Titel + Autor -->
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="title" class="form-label">Titel</label>
          <input type="text" class="form-control" id="title" placeholder="Titel" formControlName="titleControl">
        </div>
        <div class="col-md-6">
          <label for="author" class="form-label">Autor</label>
          <input type="text" class="form-control" id="author" placeholder="Autor" formControlName="authorControl">
        </div>
      </div>

      <!-- Genre + Cover -->
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="genre" class="form-label">Genre</label>
          <input type="text" class="form-control" id="genre" placeholder="Genre" formControlName="genreControl">
        </div>
        <div class="col-md-6">
          <label for="cover" class="form-label">Cover URL</label>
          <input type="text" class="form-control" id="cover" placeholder="Bild-URL" formControlName="coverControl">
        </div>
      </div>

      <!-- Status + Rating + Gesamtseiten + Gelesene Seiten -->
      <div class="row mb-3">
        <div class="col-md-3">
          <label for="status" class="form-label">Status</label>
          <select id="status" class="form-select" formControlName="statusControl">
            <option value="" disabled>Bitte wählen...</option>
            <option value="möchte lesen">möchte lesen</option>
            <option value="lese gerade">lese gerade</option>
            <option value="gelesen">gelesen</option>
          </select>
        </div>
        <div class="col-md-3">
          <label for="rating" class="form-label">Rating</label>
          <select class="form-select" id="rating"  formControlName="ratingControl">
            <option value="" disabled>Bitte auswählen</option>
            <option value="weiß nicht">weiß nicht</option>
            <option value="⭐">⭐</option>
            <option value="⭐⭐">⭐⭐</option>
            <option value="⭐⭐⭐">⭐⭐⭐</option>
            <option value="⭐⭐⭐⭐">⭐⭐⭐⭐</option>
            <option value="⭐⭐⭐⭐⭐">⭐⭐⭐⭐⭐</option>
          </select>
        </div>

        <div class="col-md-3">
          <label for="pagesTotal" class="form-label">Gesamtseiten</label>
          <input type="number" id="pagesTotal" formControlName="pagesTotalControl" class="form-control" min="1">
        </div>
        
        <div class="col-md-3">
          <label for="pagesRead" class="form-label">Gelesene Seiten</label>
          <input type="number" id="pagesRead"formControlName="pagesReadControl" class="form-control" min="0" [max]="form.controls.pagesTotalControl.value"
          [class.is-invalid]="form.controls.pagesReadControl.invalid && form.controls.pagesReadControl.touched"
          [class.is-valid]="form.controls.pagesReadControl.valid && form.controls.pagesReadControl.touched"
          required>
        @if(form.controls.pagesReadControl.errors?.['required'] && form.controls.pagesReadControl.touched) {
          <div class="invalid-feedback">Bitte angeben wie viele Seiten gelesen wurden!</div>
        }
        @if(form.controls.pagesReadControl.errors?.['max'] && form.controls.pagesReadControl.touched) {
          <div class="invalid-feedback">Gelesene Seiten dürfen nicht größer sein als die Gesamtseiten!</div>
        }
        </div>
      </div>

      <!-- Notizen -->
      <div class="mb-3">
        <label for="notes" class="form-label">Notizen</label>
        <textarea id="notes" class="form-control" placeholder="Notizen zum Buch" formControlName="notesControl"></textarea>
      </div>

      <!-- Buttons -->
      <div class="d-flex justify-content-between mt-5">
        <button type="submit" class="btn btn-primary">Aktualisieren</button>
        <button type="button" class="btn btn-secondary" (click)="cancel()">Abbrechen</button>
      </div>

    </form>
  </fieldset>
</main>
